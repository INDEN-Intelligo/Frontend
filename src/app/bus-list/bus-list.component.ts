import { HttpClient } from '@angular/common/http';
import { Component } from '@angular/core';
import { Router } from '@angular/router';
import { lastValueFrom, Observable } from 'rxjs';
import { ApiHelperService } from '../services/api-helper.service';

export interface Bus {
  id: number;
  position: number;
  weight: number;
  symbol: string;
}


@Component({
  selector: 'app-bus-list',
  templateUrl: './bus-list.component.html',
  styleUrls: ['./bus-list.component.scss']
})

export class BusListComponent {
  data: any;
  dataSource: any[] = [];
  rawData = [{"0":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:22:00+00:00"},"1":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:02:00+00:00"},"2":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:33:00+00:00"},"3":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:04:00+00:00"},"4":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:53:00+00:00"},"5":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:43:00+00:00"},"6":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:03:00+00:00"},"7":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:53:00+00:00"},"8":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:08:00+00:00"},"9":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:24:00+00:00"},"10":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:23:00+00:00"},"11":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:13:00+00:00"},"12":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:46:00+00:00"},"13":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:00:00+00:00"},"14":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:43:00+00:00"},"15":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:24:00+00:00"},"16":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:13:00+00:00"},"17":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:53:00+00:00"},"18":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:14:00+00:00"},"19":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:38:00+00:00"},"20":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:10:00+00:00"},"21":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:09:00+00:00"},"22":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:25:00+00:00"},"23":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:56:00+00:00"},"24":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:17:00+00:00"},"25":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:28:00+00:00"},"26":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:27:00+00:00"},"27":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:31:00+00:00"},"28":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:45:00+00:00"},"29":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:56:00+00:00"},"30":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:34:00+00:00"},"31":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:23:00+00:00"},"32":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:53:00+00:00"},"33":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T09:44:00+00:00"},"34":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:33:00+00:00"},"35":{"id":"0004","sens":"0","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:12:00+00:00"},"36":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:39:00+00:00"},"37":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T11:40:00+00:00"},"38":{"id":"0010","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:55:00+00:00"},"39":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:43:00+00:00"},"40":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:13:00+00:00"},"41":{"id":"0014","sens":"1","position":{"latitude":"48.119028","longitude":"-1.63521"},"arriveetheorique":"2023-04-27T10:59:00+00:00"}},{"0":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:08:00+00:00"},"1":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:59:00+00:00"},"2":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:19:00+00:00"},"3":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:49:00+00:00"},"4":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:09:00+00:00"},"5":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T12:00:00+00:00"},"6":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:19:00+00:00"},"7":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:51:00+00:00"},"8":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:06:00+00:00"},"9":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:51:00+00:00"},"10":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:08:00+00:00"},"11":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:51:00+00:00"},"12":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:49:00+00:00"},"13":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:38:00+00:00"},"14":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:29:00+00:00"},"15":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:08:00+00:00"},"16":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:39:00+00:00"},"17":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:29:00+00:00"},"18":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:36:00+00:00"},"19":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:21:00+00:00"},"20":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:06:00+00:00"},"21":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:36:00+00:00"},"22":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:06:00+00:00"},"23":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:06:00+00:00"},"24":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:21:00+00:00"},"25":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:58:00+00:00"},"26":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:18:00+00:00"},"27":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:48:00+00:00"},"28":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:28:00+00:00"},"29":{"id":"0004","sens":"1","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:39:00+00:00"},"30":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:21:00+00:00"},"31":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:21:00+00:00"},"32":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:51:00+00:00"},"33":{"id":"0010","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:36:00+00:00"},"34":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:36:00+00:00"},"35":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:37:00+00:00"},"36":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T09:21:00+00:00"},"37":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T12:01:00+00:00"},"38":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:06:00+00:00"},"39":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:36:00+00:00"},"40":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:20:00+00:00"},"41":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T10:51:00+00:00"},"42":{"id":"0014","sens":"0","position":{"latitude":"48.119039","longitude":"-1.635045"},"arriveetheorique":"2023-04-27T11:51:00+00:00"}}]

  
  constructor(

    private router : Router,
    private http: HttpClient,

    private api: ApiHelperService,
  ) {}



  displayedColumns: string[] = ['id', 'sens', 'latitude','longitude','horraire'];
  
  ngOnInit(): void {
    console.log(this.dataSource);
    this.get();
    for (const [key, value] of Object.entries(this.rawData[0])) {
      console.log(value);
      this.dataSource.push(value);

    }


    
  }

  get(){

    //send a request with the HTTP client to the api
    const resquest: Observable<any> = this.http.get('http://localhost:3000/bus', { observe: 'response' });
    lastValueFrom(resquest).then((response: { body: any; }) => {
      console.log(this.dataSource);
      this.data = response.body;

    });

  }

}